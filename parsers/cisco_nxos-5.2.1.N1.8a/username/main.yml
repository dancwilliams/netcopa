- name: username
  tags:
  - username
  matches:
  - name: username
    template: username/default.j2
    lines:
    - regex: '^username (\w+) password (\d) (\S+)  role (\S+)$'
      examples:
      - 'username admin password 5 AAAAAAAAAAAAA  role network-admin'
      captures:
      - username
      - encryption_type
      - password
      - role
      path:
        usernames:
        - username: "{{ username }}"
          encryption_type: "{{ encryption_type }}"
          password: "{{ password }}"
          role: "{{ role }}"
  - name: password strength check
    template: username/password-check.j2
    lines:
    - regex: '^no password strength-check$'
      examples:
      - 'no password strength-check'
      path:
        password-strength-check:
          negate: True
