- name: aaa groups
  tags:
  - aaa
  - group
  matches:
  - name: aaa group
    template: aaa/groups.j2
    lines:
    - regex: '^aaa group server (\S+) (\S+)$'
      exmaples:
      - 'aaa group server tacacs+ tacacs-servers'
      captures:
      - group_type
      - group_name
      path:
        aaa:
          groups:
            "{{ group_name }}":
              name: "{{ group_name }}"
              type: "{{ group_type }}"
      lines:
      - regex: '^    server (\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})$'
        examples:
        - '    server 10.1.1.1'
        captures:
        - server_ip
        path:
          aaa:
            groups:
              "{{ group_name }}":
                servers:
                - ip: "{{ server_ip }}"
      - regex: '^    use-vrf (\S+)$'
        examples:
        - '    use-vrf management'
        captures:
        - vrf
        path:
          aaa:
            groups:
              "{{ group_name }}":
                forwarding_vrf: "\"{{ vrf }}\""